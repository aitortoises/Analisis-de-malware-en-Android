# Análisis de Malware en Android

Guía teórico-práctica para el Análisis de Malware en Android.<br>
Incluye el análisis de dos muestras de malware: Mazain y Anubis.

![](https://i.imgur.com/GdqYWEC.png)

## Guía

La guía puede ser visualizada [AQUÍ](https://github.com/aitortoises/Analisis-de-malware-en-Android/blob/master/Analisis_de_malware_en_Android.pdf).<br>

## Recursos

* **trafico_red.pcap:** Captura del tráfico de red generado por la muestra Mazain.
* **analizar_pcap:** Filtra las conexiones http encontradas en el fichero pcap e imprime la información obtenida.
* **descifrar_mazain.py:** Realiza el descifrado de los mensajes entre la muestra Mazain y el servidor.
* **panel_bots.py:** Obtiene los bots del panel de control de la muestra Mazain e imprime la información en un fichero csv.
* **desempaquetar_apk.py:** Extrae información sobre el APK. Realiza el desempaquetado utilizando Apktool, extrae el código Java de la aplicación con Jadx y realiza el desensamblado de código nativo con Ndk. También extrae el certificado y las cadenas de texto filtrando por clases y por http/https, incluidas sus decodificaciones en base64 y hexadecimal.
* **frida_hook.js:** Anula la función de borrado del fichero descifrado. Sustituye la función unlinkat() por una vacía.
* **obtener_payload:** Automatiza la instalación de la muestra Anubis y la utilización de Frida para la posterios extracción del fichero descifrado.


## Demo

Ejecución de las muestras de malware analizadas.

### Mazain

Superposición y robo de credenciales bancarias:<br>

![](https://media.giphy.com/media/2xPJD5AAE4QPUJluUk/giphy.gif)

### Anubis

Ejecución y posterior intento de desinstalación:<br>

![](https://media.giphy.com/media/8vF6PM1vgcz4feI3rA/giphy.gif)

